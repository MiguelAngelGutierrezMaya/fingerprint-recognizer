# Service

![](data:image/png;base64,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)

**Tabla de contenido**

[TOC]

#Especificación técnica de variables
##Archivos de entorno
La configuración de las variables de entorno se explican a continuación:
- **DJANGO_APP_URL**: Ruta de la aplicación frontend
- **DJANGO_MEDIA_URL**: Ruta de los archivos media
- **DJANGO_SETTINGS_MODULE**: Modulo de configuración de Django valor por defecto: *"service_backend.settings.local"*
- **DJANGO_SECRET_KEY**: Llave secreta de la aplicación
- **DJANGO_ADMIN_URL**: Ruta del administrador de Django
- **DJANGO_ALLOWED_HOSTS**: Host permitidos para la comunicación con el api
-**DJANGO_CORS_ORIGIN_WHITELIST**: Host en lista blanca para acceder a comunicaciones con el rest framework
- **NOTIFIER_EMAIL**: email para envío de notificaciones
- **NOTIFIER_NAME**: Nombre de cabeza de notificaciones, por defecto: *"Service"*
- **USERNAME_SMTP**: Usuario smtp
- **PASSWORD_SMTP**: Contraseña del usuario smtp
- **HOST_SMTP**: Servicio host del smtp
- **PORT_SMTP**: Puerto del servicio

#Proceso de instalación
Verificar la instalación de la base de datos postgresql y configurar las credenciales en los archivos de entorno (desarrollo o producción)
en caso de no estar instalada, ejecutar el siguiente comando

`$ docker run --detach --name postgres-dev --network=contenedores -e POSTGRES_PASSWORD=t00r -e VIRTUAL_HOST=postgres-dev -v [local-path]:/var/lib/postgresql/data -p 5433:5432 postgres:12`

Verificar que la red contenedores se encuentre creada y la [local-path] sea una ruta local con accesos de escritura y lectura

Ejecutar el siguiente comando (tener en cuenta el entorno en el que se encuentra, desarrollo o producción):

`$ docker-compose -f docker-compose.local.yml build`

Establecer las migraciones iniciales

`$ docker-compose -f docker-compose.local.yml run --rm django python manage.py migrate`

Agregar los primeros datos requeridos por defecto en la Base de datos para las tablas roles, documentos, ciudades, estados y paises

Crear el usuario superadmin

`$ docker-compose -f docker-compose.local.yml run --rm django python manage.py createsuperuser`

Si te encuentras en la instalación en un entorno de producción, debes configurar las tareas programadas en el servicio cron del vps, un ejemplo se muestra a continuación:

`$ crontab -e`

Pegar el texto que se encuentra en el archivo `.cronjobs` de la carpeta `.envs/.local/` al final

Reinicializar el servicio de tareas

`$ sudo service cron restart`

Ejecución del proyecto en local

`$ docker-compose -f docker-compose.local.yml up`

Se levanta una instancia por defecto en http://localhost:9000
de no ser así verificar en que puerto está corriendo el proyecto, para ello se puede hacer uso del siguiente comando

`$ docker ps`
